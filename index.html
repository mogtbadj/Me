<script>
async function getCode() {
  const name = document.getElementById("name").value.trim();
  if(!name) { alert("Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ"); return; }

  // Ø¬Ù„Ø¨ JSON
  let response = await fetch('codes.json');
  let data = await response.json();

  const today = new Date().toISOString().split('T')[0];
  let user = data.find(u => u.name === name && u.date === today);

  if(!user){
    user = { name: name, date: today, codes: [] };
    data.push(user);
  }

  if(user.codes.length >= 5){
    document.getElementById("codeBox").innerText = "âŒ Ø§Ù†ØªÙ‡Øª Ø£ÙƒÙˆØ§Ø¯Ùƒ Ø§Ù„ÙŠÙˆÙ…";
    document.getElementById("dailyInfo").innerText = `ğŸ“Š Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…ÙˆØ²Ø¹Ø© Ø§Ù„ÙŠÙˆÙ…: ${user.codes.length}`;
    return;
  }

  const randomCode = "MSC-" + Math.floor(1000 + Math.random() * 9000);
  user.codes.push(randomCode);

  // Ù‡Ù†Ø§ Ø­Ù†ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯ Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ© ÙÙŠ JSON Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙŠØ±ÙØ±  
  // âš ï¸ fetch Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù‡ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª Ù…Ø¨Ø§Ø´Ø±Ø©ØŒ Ù…Ø­ØªØ§Ø¬ Ø³ÙŠØ±ÙØ± ØµØºÙŠØ± (Node.js Ù…Ø«Ù„Ø§)
  
  document.getElementById("codeBox").innerText = "ğŸ ÙƒÙˆØ¯Ùƒ: " + randomCode;
  document.getElementById("dailyInfo").innerText = `ğŸ“Š Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…ÙˆØ²Ø¹Ø© Ø§Ù„ÙŠÙˆÙ…: ${user.codes.length}`;
}
</script>
